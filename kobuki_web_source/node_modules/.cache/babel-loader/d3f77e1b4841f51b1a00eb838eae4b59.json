{"ast":null,"code":"var _jsxFileName = \"/home/binhlee/Desktop/kobuki_web_source/src/components/Controller/Controller.js\";\nimport React, { Component } from \"react\";\nimport { Container, Card, Col, Row, Button, ButtonGroup, ToggleButton } from \"react-bootstrap\";\nimport \"../CommonStyle.css\";\nimport \"./Controller.css\";\nimport { Direction } from \"../Common/Common.ts\";\nimport ROSLIB from \"roslib\";\nconst Command = [{\n  dir: Direction.NorthWest,\n  code: 81\n}, {\n  dir: Direction.North,\n  code: 87\n}, {\n  dir: Direction.NorthEast,\n  code: 69\n}, {\n  dir: Direction.West,\n  code: 65\n}, {\n  dir: Direction.Center,\n  code: 88\n}, {\n  dir: Direction.East,\n  code: 68\n}, {\n  dir: Direction.SouthWest,\n  code: 90\n}, {\n  dir: Direction.South,\n  code: 83\n}, {\n  dir: Direction.SouthEast,\n  code: 67\n}];\n\nfunction ControlButton(props) {\n  return /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    size: \"lg\",\n    className: \"button-control\",\n    onClick: props.onClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 10\n    }\n  }, props.label);\n}\n\nfunction ButtonDonotThing(props) {\n  return /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    size: \"lg\",\n    className: \"button-donot-thing\",\n    onClick: props.onClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 10\n    }\n  }, props.label);\n}\n\nconst radios = [{\n  name: 'Mapping',\n  value: '1'\n}, {\n  name: 'Localization',\n  value: '2'\n}];\nconst arrVel = [[[1, 0, 0, 0, 0, 1], [1, 0, 0, 0, 0, 0], [1, 0, 0, 0, 0, -1], [0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, -1], [-1, 0, 0, 0, 0, -1], [-1, 0, 0, 0, 0, 0], [-1, 0, 0, 0, 0, 1]], [[1, -1, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0], [1, 1, 0, 0, 0, 0], [0, -1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 1, 0, 0, 0, 0], [-1, -1, 0, 0, 0, 0], [-1, 0, 0, 0, 0, 0], [-1, 1, 0, 0, 0, 0]]];\n\nclass Controller extends Component {\n  constructor(props) {\n    super(props); // this.onControl = props.onControl;\n\n    this._handleKeyDown = event => {\n      // console.log(\"pressed \" + event.keyCode);\n      let target = Command.find(item => {\n        if (item.code === event.keyCode) {\n          return item;\n        }\n      });\n\n      if (target) {\n        // console.log(\"press dir \" + target.dir);\n        this.onControl(0, target.dir);\n      }\n    };\n\n    this.state = {\n      keyboard_enable: false,\n      radioValue: '1',\n      checked: false\n    };\n    this.angularVel = props.angularVel || 0;\n    this.linearVel = props.linearVel || 0;\n    this.ros = props.ros || null;\n    this.addEventKeyboard = false;\n    this.onChangeKeyboardControl = this.onChangeKeyboardControl.bind(this);\n    this.onClickControlButton = this.onClickControlButton.bind(this);\n    this._handleKeyDown = this._handleKeyDown.bind(this);\n    this.onControl = this.onControl.bind(this);\n    this.cur_dir = 4; // stop\n\n    this.cmdVel = null;\n    this.mappingModeService = null;\n    this.localizationModeService = null;\n  }\n\n  componentDidUpdate() {\n    this.angularVel = this.props.angularVel || 0;\n    this.linearVel = this.props.linearVel || 0;\n\n    if (this.ros !== this.props.ros) {\n      this.ros = this.props.ros;\n\n      if (this.ros != null) {\n        console.log('abc');\n        this.cmdVel = new ROSLIB.Topic({\n          ros: this.ros,\n          name: '/cmd_vel_mux/safety_controller',\n          messageType: 'geometry_msgs/Twist'\n        });\n        var newVelMsg = new ROSLIB.Message({\n          linear: {\n            x: 0,\n            y: 0,\n            z: 0\n          },\n          angular: {\n            x: 0,\n            y: 0,\n            z: 0\n          }\n        });\n        this.cur_dir = 4;\n        this.cmdVel.publish(newVelMsg);\n        this.mappingModeService = new ROSLIB.Service({\n          ros: this.ros,\n          name: '/rtabmap/set_mode_mapping',\n          serviceType: 'std_srvs/Empty'\n        });\n        this.localizationModeService = new ROSLIB.Service({\n          ros: this.ros,\n          name: '/rtabmap/set_mode_localization',\n          serviceType: 'std_srvs/Empty'\n        });\n      }\n    }\n  }\n\n  componentDidMount() {// BannerDataStore.addChangeListener(this._onchange);\n    // document.addEventListener(\"keydown\", this._handleKeyDown);\n  }\n\n  componentWillUnmount() {\n    // BannerDataStore.removeChangeListener(this._onchange);\n    if (this.addEventKeyboard) {\n      document.removeEventListener(\"keydown\", this._handleKeyDown);\n    }\n  }\n\n  onChangeKeyboardControl(event) {\n    console.log(\"change switch \" + event.target.checked);\n    this.setState({\n      keyboard_enable: event.target.checked\n    });\n\n    if (event.target.checked === true) {\n      if (!this.addEventKeyboard) {\n        console.log(\"Enable keyboard\");\n        document.addEventListener(\"keydown\", this._handleKeyDown);\n        this.addEventKeyboard = true;\n      }\n    } else if (event.target.checked === false) {\n      if (this.addEventKeyboard) {\n        console.log(\"Disable keyboard\");\n        document.removeEventListener(\"keydown\", this._handleKeyDown);\n        this.addEventKeyboard = false;\n      }\n    }\n  }\n\n  onControl(mode, dir) {\n    this.cur_dir = dir;\n\n    if (!this.cmdVel || this.ros == null) {\n      return;\n    }\n\n    console.log(\"mode \" + mode + \" direction \" + dir + \" with velocity \" + this.linearVel + \", \" + this.angularVel);\n\n    if (mode > 1 || mode < 0 || dir < 0 || dir > 9) {\n      console.log(\"Invalid control\");\n    }\n\n    var newVelMsg = new ROSLIB.Message({\n      linear: {\n        x: arrVel[mode][dir][0] * this.linearVel,\n        y: arrVel[mode][dir][1] * this.linearVel,\n        z: arrVel[mode][dir][2] * this.linearVel\n      },\n      angular: {\n        x: arrVel[mode][dir][3] * this.angularVel,\n        y: arrVel[mode][dir][4] * this.angularVel,\n        z: arrVel[mode][dir][5] * this.angularVel\n      }\n    });\n    this.cmdVel.publish(newVelMsg);\n  }\n\n  onClickControlButton(direction) {\n    console.log(\"click \" + direction);\n    this.onControl(0, direction);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      className: \"box-margin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      border: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Card.Header, {\n      style: {\n        fontSize: \"1.2rem\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 54\n      }\n    }, \"Controller\")), /*#__PURE__*/React.createElement(Card.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 15\n      }\n    }, \"Keyboard Control\"), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      className: \"switch\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      onChange: this.onChangeKeyboardControl,\n      checked: this.state.keyboard_enable,\n      type: \"checkbox\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"slider round\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 19\n      }\n    })))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"Q\",\n      onClick: () => this.onClickControlButton(Direction.NorthWest),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 20\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"W\",\n      onClick: () => this.onClickControlButton(Direction.North),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 20\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"E\",\n      onClick: () => this.onClickControlButton(Direction.NorthEast),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 20\n      }\n    }))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"A\",\n      onClick: () => this.onClickControlButton(Direction.West),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 20\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ButtonDonotThing, {\n      label: \"\",\n      onClick: () => this.onClickControlButton(Direction.Center),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"D\",\n      onClick: () => this.onClickControlButton(Direction.East),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 20\n      }\n    }))), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"Z\",\n      onClick: () => this.onClickControlButton(Direction.SouthWest),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 20\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"S\",\n      onClick: () => this.onClickControlButton(Direction.South),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 20\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ControlButton, {\n      label: \"C\",\n      onClick: () => this.onClickControlButton(Direction.SouthEast),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 20\n      }\n    }))), /*#__PURE__*/React.createElement(Row, {\n      style: {\n        marginTop: \"1rem\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      sm: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        margin: \"0.5rem\",\n        fontSize: \"1.1rem\",\n        textAlign: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 27\n      }\n    }, \"Mode\")), /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(ButtonGroup, {\n      toggle: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }\n    }, radios.map((radio, idx) => /*#__PURE__*/React.createElement(ToggleButton, {\n      key: idx,\n      type: \"radio\",\n      variant: \"secondary\",\n      name: \"radio\",\n      value: radio.value,\n      checked: this.state.radioValue === radio.value,\n      onChange: e => {\n        this.setState({\n          radioValue: e.currentTarget.value\n        });\n        e.currentTarget.value === '1' ? this.mappingModeService.callService() : this.localizationModeService.callService();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }\n    }, radio.name))))))));\n  }\n\n}\n\nexport default Controller;","map":{"version":3,"sources":["/home/binhlee/Desktop/kobuki_web_source/src/components/Controller/Controller.js"],"names":["React","Component","Container","Card","Col","Row","Button","ButtonGroup","ToggleButton","Direction","ROSLIB","Command","dir","NorthWest","code","North","NorthEast","West","Center","East","SouthWest","South","SouthEast","ControlButton","props","onClick","label","ButtonDonotThing","radios","name","value","arrVel","Controller","constructor","_handleKeyDown","event","target","find","item","keyCode","onControl","state","keyboard_enable","radioValue","checked","angularVel","linearVel","ros","addEventKeyboard","onChangeKeyboardControl","bind","onClickControlButton","cur_dir","cmdVel","mappingModeService","localizationModeService","componentDidUpdate","console","log","Topic","messageType","newVelMsg","Message","linear","x","y","z","angular","publish","Service","serviceType","componentDidMount","componentWillUnmount","document","removeEventListener","setState","addEventListener","mode","direction","render","fontSize","marginTop","margin","textAlign","map","radio","idx","e","currentTarget","callService"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,SAAT,EAAoBC,IAApB,EAA0BC,GAA1B,EAA+BC,GAA/B,EAAoCC,MAApC,EAA4CC,WAA5C,EAAyDC,YAAzD,QAA6E,iBAA7E;AACA,OAAO,oBAAP;AACA,OAAO,kBAAP;AACA,SAASC,SAAT,QAA0B,qBAA1B;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,MAAMC,OAAO,GAAG,CACd;AACEC,EAAAA,GAAG,EAAEH,SAAS,CAACI,SADjB;AAC4BC,EAAAA,IAAI,EAAE;AADlC,CADc,EAId;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACM,KADjB;AACwBD,EAAAA,IAAI,EAAE;AAD9B,CAJc,EAOd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACO,SADjB;AAC4BF,EAAAA,IAAI,EAAE;AADlC,CAPc,EAUd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACQ,IADjB;AACuBH,EAAAA,IAAI,EAAE;AAD7B,CAVc,EAad;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACS,MADjB;AACyBJ,EAAAA,IAAI,EAAE;AAD/B,CAbc,EAgBd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACU,IADjB;AACuBL,EAAAA,IAAI,EAAE;AAD7B,CAhBc,EAmBd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACW,SADjB;AAC4BN,EAAAA,IAAI,EAAE;AADlC,CAnBc,EAsBd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACY,KADjB;AACwBP,EAAAA,IAAI,EAAE;AAD9B,CAtBc,EAyBd;AACEF,EAAAA,GAAG,EAAEH,SAAS,CAACa,SADjB;AAC4BR,EAAAA,IAAI,EAAE;AADlC,CAzBc,CAAhB;;AA8BA,SAASS,aAAT,CAAuBC,KAAvB,EAA8B;AAC5B,sBAAO,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,WAAhB;AAA4B,IAAA,IAAI,EAAC,IAAjC;AAAsC,IAAA,SAAS,EAAC,gBAAhD;AAAiE,IAAA,OAAO,EAAEA,KAAK,CAACC,OAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0FD,KAAK,CAACE,KAAhG,CAAP;AACD;;AAED,SAASC,gBAAT,CAA0BH,KAA1B,EAAiC;AAC/B,sBAAO,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,WAAhB;AAA4B,IAAA,IAAI,EAAC,IAAjC;AAAsC,IAAA,SAAS,EAAC,oBAAhD;AAAqE,IAAA,OAAO,EAAEA,KAAK,CAACC,OAApF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA8FD,KAAK,CAACE,KAApG,CAAP;AACD;;AAED,MAAME,MAAM,GAAG,CACb;AAAEC,EAAAA,IAAI,EAAE,SAAR;AAAmBC,EAAAA,KAAK,EAAE;AAA1B,CADa,EAEb;AAAED,EAAAA,IAAI,EAAE,cAAR;AAA0BC,EAAAA,KAAK,EAAE;AAAjC,CAFa,CAAf;AAKA,MAAMC,MAAM,GAAG,CACb,CACE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CADF,EAEE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAFF,EAGE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAC,CAAjB,CAHF,EAIE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAJF,EAKE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CALF,EAME,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAC,CAAjB,CANF,EAOE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAC,CAAlB,CAPF,EAQE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CARF,EASE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CATF,CADa,EAYb,CACE,CAAC,CAAD,EAAI,CAAC,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CADF,EAEE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAFF,EAGE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CAHF,EAIE,CAAC,CAAD,EAAI,CAAC,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CAJF,EAKE,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CALF,EAME,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,CANF,EAOE,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN,EAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAPF,EAQE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CARF,EASE,CAAC,CAAC,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,CATF,CAZa,CAAf;;AAyBA,MAAMC,UAAN,SAAyB/B,SAAzB,CAAmC;AACjCgC,EAAAA,WAAW,CAACT,KAAD,EAAQ;AACjB,UAAMA,KAAN,EADiB,CAEjB;;AAFiB,SAsBnBU,cAtBmB,GAsBDC,KAAD,IAAW;AAC1B;AACA,UAAIC,MAAM,GAAGzB,OAAO,CAAC0B,IAAR,CAAaC,IAAI,IAAI;AAChC,YAAIA,IAAI,CAACxB,IAAL,KAAcqB,KAAK,CAACI,OAAxB,EAAiC;AAC/B,iBAAOD,IAAP;AACD;AACF,OAJY,CAAb;;AAKA,UAAIF,MAAJ,EAAY;AACV;AACA,aAAKI,SAAL,CAAe,CAAf,EAAkBJ,MAAM,CAACxB,GAAzB;AACD;AACF,KAjCkB;;AAGjB,SAAK6B,KAAL,GAAa;AACXC,MAAAA,eAAe,EAAE,KADN;AAEXC,MAAAA,UAAU,EAAE,GAFD;AAGXC,MAAAA,OAAO,EAAE;AAHE,KAAb;AAKA,SAAKC,UAAL,GAAkBrB,KAAK,CAACqB,UAAN,IAAoB,CAAtC;AACA,SAAKC,SAAL,GAAiBtB,KAAK,CAACsB,SAAN,IAAmB,CAApC;AACA,SAAKC,GAAL,GAAWvB,KAAK,CAACuB,GAAN,IAAa,IAAxB;AACA,SAAKC,gBAAL,GAAwB,KAAxB;AACA,SAAKC,uBAAL,GAA+B,KAAKA,uBAAL,CAA6BC,IAA7B,CAAkC,IAAlC,CAA/B;AACA,SAAKC,oBAAL,GAA4B,KAAKA,oBAAL,CAA0BD,IAA1B,CAA+B,IAA/B,CAA5B;AACA,SAAKhB,cAAL,GAAsB,KAAKA,cAAL,CAAoBgB,IAApB,CAAyB,IAAzB,CAAtB;AACA,SAAKV,SAAL,GAAiB,KAAKA,SAAL,CAAeU,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKE,OAAL,GAAe,CAAf,CAhBiB,CAgBC;;AAClB,SAAKC,MAAL,GAAc,IAAd;AACA,SAAKC,kBAAL,GAA0B,IAA1B;AACA,SAAKC,uBAAL,GAA+B,IAA/B;AACD;;AAeDC,EAAAA,kBAAkB,GAAG;AACnB,SAAKX,UAAL,GAAkB,KAAKrB,KAAL,CAAWqB,UAAX,IAAyB,CAA3C;AACA,SAAKC,SAAL,GAAiB,KAAKtB,KAAL,CAAWsB,SAAX,IAAwB,CAAzC;;AACA,QAAI,KAAKC,GAAL,KAAa,KAAKvB,KAAL,CAAWuB,GAA5B,EAAiC;AAC/B,WAAKA,GAAL,GAAW,KAAKvB,KAAL,CAAWuB,GAAtB;;AACA,UAAI,KAAKA,GAAL,IAAY,IAAhB,EAAsB;AACpBU,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA,aAAKL,MAAL,GAAc,IAAI3C,MAAM,CAACiD,KAAX,CAAiB;AAC7BZ,UAAAA,GAAG,EAAG,KAAKA,GADkB;AAE7BlB,UAAAA,IAAI,EAAG,gCAFsB;AAG7B+B,UAAAA,WAAW,EAAG;AAHe,SAAjB,CAAd;AAKA,YAAIC,SAAS,GAAG,IAAInD,MAAM,CAACoD,OAAX,CAAmB;AACjCC,UAAAA,MAAM,EAAG;AACPC,YAAAA,CAAC,EAAG,CADG;AAEPC,YAAAA,CAAC,EAAG,CAFG;AAGPC,YAAAA,CAAC,EAAG;AAHG,WADwB;AAMjCC,UAAAA,OAAO,EAAG;AACRH,YAAAA,CAAC,EAAG,CADI;AAERC,YAAAA,CAAC,EAAG,CAFI;AAGRC,YAAAA,CAAC,EAAG;AAHI;AANuB,SAAnB,CAAhB;AAYA,aAAKd,OAAL,GAAe,CAAf;AACA,aAAKC,MAAL,CAAYe,OAAZ,CAAoBP,SAApB;AAEA,aAAKP,kBAAL,GAA0B,IAAI5C,MAAM,CAAC2D,OAAX,CAAmB;AAC3CtB,UAAAA,GAAG,EAAE,KAAKA,GADiC;AAE3ClB,UAAAA,IAAI,EAAE,2BAFqC;AAG3CyC,UAAAA,WAAW,EAAE;AAH8B,SAAnB,CAA1B;AAKA,aAAKf,uBAAL,GAA+B,IAAI7C,MAAM,CAAC2D,OAAX,CAAmB;AAChDtB,UAAAA,GAAG,EAAE,KAAKA,GADsC;AAEhDlB,UAAAA,IAAI,EAAE,gCAF0C;AAGhDyC,UAAAA,WAAW,EAAE;AAHmC,SAAnB,CAA/B;AAKD;AACF;AACF;;AAEDC,EAAAA,iBAAiB,GAAG,CAClB;AACA;AACD;;AAEDC,EAAAA,oBAAoB,GAAG;AACrB;AACA,QAAI,KAAKxB,gBAAT,EAA2B;AACzByB,MAAAA,QAAQ,CAACC,mBAAT,CAA6B,SAA7B,EAAwC,KAAKxC,cAA7C;AACD;AACF;;AAEDe,EAAAA,uBAAuB,CAACd,KAAD,EAAQ;AAC7BsB,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAmBvB,KAAK,CAACC,MAAN,CAAaQ,OAA5C;AACA,SAAK+B,QAAL,CAAc;AAAEjC,MAAAA,eAAe,EAAEP,KAAK,CAACC,MAAN,CAAaQ;AAAhC,KAAd;;AACA,QAAIT,KAAK,CAACC,MAAN,CAAaQ,OAAb,KAAyB,IAA7B,EAAmC;AACjC,UAAI,CAAC,KAAKI,gBAAV,EAA4B;AAC1BS,QAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACAe,QAAAA,QAAQ,CAACG,gBAAT,CAA0B,SAA1B,EAAqC,KAAK1C,cAA1C;AACA,aAAKc,gBAAL,GAAwB,IAAxB;AACD;AACF,KAND,MAMO,IAAIb,KAAK,CAACC,MAAN,CAAaQ,OAAb,KAAyB,KAA7B,EAAoC;AACzC,UAAI,KAAKI,gBAAT,EAA2B;AACzBS,QAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACAe,QAAAA,QAAQ,CAACC,mBAAT,CAA6B,SAA7B,EAAwC,KAAKxC,cAA7C;AACA,aAAKc,gBAAL,GAAwB,KAAxB;AACD;AACF;AACF;;AAEDR,EAAAA,SAAS,CAACqC,IAAD,EAAOjE,GAAP,EAAY;AACnB,SAAKwC,OAAL,GAAexC,GAAf;;AACA,QAAI,CAAC,KAAKyC,MAAN,IAAgB,KAAKN,GAAL,IAAY,IAAhC,EAAsC;AACpC;AACD;;AACDU,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAUmB,IAAV,GAAiB,aAAjB,GAAiCjE,GAAjC,GAAuC,iBAAvC,GAA2D,KAAKkC,SAAhE,GAA4E,IAA5E,GAAmF,KAAKD,UAApG;;AACA,QAAIgC,IAAI,GAAG,CAAP,IAAYA,IAAI,GAAG,CAAnB,IAAwBjE,GAAG,GAAG,CAA9B,IAAmCA,GAAG,GAAG,CAA7C,EAAgD;AAC9C6C,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACD;;AACD,QAAIG,SAAS,GAAG,IAAInD,MAAM,CAACoD,OAAX,CAAmB;AACjCC,MAAAA,MAAM,EAAG;AACPC,QAAAA,CAAC,EAAGjC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKkC,SADzB;AAEPmB,QAAAA,CAAC,EAAGlC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKkC,SAFzB;AAGPoB,QAAAA,CAAC,EAAGnC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKkC;AAHzB,OADwB;AAMjCqB,MAAAA,OAAO,EAAG;AACRH,QAAAA,CAAC,EAAGjC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKiC,UADxB;AAERoB,QAAAA,CAAC,EAAGlC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKiC,UAFxB;AAGRqB,QAAAA,CAAC,EAAGnC,MAAM,CAAC8C,IAAD,CAAN,CAAajE,GAAb,EAAkB,CAAlB,IAAuB,KAAKiC;AAHxB;AANuB,KAAnB,CAAhB;AAYA,SAAKQ,MAAL,CAAYe,OAAZ,CAAoBP,SAApB;AACD;;AAEDV,EAAAA,oBAAoB,CAAC2B,SAAD,EAAY;AAC9BrB,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAWoB,SAAvB;AACA,SAAKtC,SAAL,CAAe,CAAf,EAAkBsC,SAAlB;AACD;;AAEDC,EAAAA,MAAM,GAAG;AACP,wBACE,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAC,YAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD;AAAM,MAAA,MAAM,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,IAAD,CAAM,MAAN;AAAa,MAAA,KAAK,EAAE;AAACC,QAAAA,QAAQ,EAAE;AAAX,OAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA2C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA3C,CADF,eAEE,oBAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAO,MAAA,SAAS,EAAC,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAO,MAAA,QAAQ,EAAE,KAAK/B,uBAAtB;AAA+C,MAAA,OAAO,EAAE,KAAKR,KAAL,CAAWC,eAAnE;AAAoF,MAAA,IAAI,EAAC,UAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE;AAAM,MAAA,SAAS,EAAC,cAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF,CAFF,CADF,eAUE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKS,oBAAL,CAA0B1C,SAAS,CAACI,SAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKsC,oBAAL,CAA0B1C,SAAS,CAACM,KAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CAFF,eAGE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKoC,oBAAL,CAA0B1C,SAAS,CAACO,SAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CAHF,CAVF,eAeE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKmC,oBAAL,CAA0B1C,SAAS,CAACQ,IAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAM,oBAAC,gBAAD;AAAkB,MAAA,KAAK,EAAC,EAAxB;AAA2B,MAAA,OAAO,EAAE,MAAM,KAAKkC,oBAAL,CAA0B1C,SAAS,CAACS,MAApC,CAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAN,CAFF,eAGE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKiC,oBAAL,CAA0B1C,SAAS,CAACU,IAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CAHF,CAfF,eAoBE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKgC,oBAAL,CAA0B1C,SAAS,CAACW,SAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAK+B,oBAAL,CAA0B1C,SAAS,CAACY,KAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CAFF,eAGE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAK,oBAAC,aAAD;AAAe,MAAA,KAAK,EAAC,GAArB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAK8B,oBAAL,CAA0B1C,SAAS,CAACa,SAApC,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAL,CAHF,CApBF,eA4BE,oBAAC,GAAD;AAAK,MAAA,KAAK,EAAE;AAAC2D,QAAAA,SAAS,EAAE;AAAZ,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAY;AAAG,MAAA,KAAK,EAAE;AAACC,QAAAA,MAAM,EAAE,QAAT;AAAmBF,QAAAA,QAAQ,EAAE,QAA7B;AAAuCG,QAAAA,SAAS,EAAE;AAAlD,OAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAZ,CADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,WAAD;AAAa,MAAA,MAAM,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGvD,MAAM,CAACwD,GAAP,CAAW,CAACC,KAAD,EAAQC,GAAR,kBACV,oBAAC,YAAD;AACE,MAAA,GAAG,EAAEA,GADP;AAEE,MAAA,IAAI,EAAC,OAFP;AAGE,MAAA,OAAO,EAAC,WAHV;AAIE,MAAA,IAAI,EAAC,OAJP;AAKE,MAAA,KAAK,EAAED,KAAK,CAACvD,KALf;AAME,MAAA,OAAO,EAAE,KAAKW,KAAL,CAAWE,UAAX,KAA0B0C,KAAK,CAACvD,KAN3C;AAOE,MAAA,QAAQ,EAAKyD,CAAD,IAAO;AACjB,aAAKZ,QAAL,CAAc;AAAChC,UAAAA,UAAU,EAAE4C,CAAC,CAACC,aAAF,CAAgB1D;AAA7B,SAAd;AACAyD,QAAAA,CAAC,CAACC,aAAF,CAAgB1D,KAAhB,KAA0B,GAA1B,GAAgC,KAAKwB,kBAAL,CAAwBmC,WAAxB,EAAhC,GAAwE,KAAKlC,uBAAL,CAA6BkC,WAA7B,EAAxE;AACD,OAVH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAWGJ,KAAK,CAACxD,IAXT,CADD,CADH,CADF,CAFF,CA5BF,CAFF,CADF,CADF;AA0DD;;AAnMgC;;AAsMnC,eAAeG,UAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { Container, Card, Col, Row, Button, ButtonGroup, ToggleButton } from \"react-bootstrap\";\nimport \"../CommonStyle.css\";\nimport \"./Controller.css\";\nimport { Direction } from \"../Common/Common.ts\";\nimport ROSLIB from \"roslib\";\n\nconst Command = [\n  {\n    dir: Direction.NorthWest, code: 81\n  },\n  {\n    dir: Direction.North, code: 87\n  },\n  {\n    dir: Direction.NorthEast, code: 69\n  },\n  {\n    dir: Direction.West, code: 65\n  },\n  {\n    dir: Direction.Center, code: 88\n  },\n  {\n    dir: Direction.East, code: 68\n  },\n  {\n    dir: Direction.SouthWest, code: 90\n  },\n  {\n    dir: Direction.South, code: 83\n  },\n  {\n    dir: Direction.SouthEast, code: 67\n  },\n];\n\nfunction ControlButton(props) {\n  return <Button variant=\"secondary\" size=\"lg\" className=\"button-control\" onClick={props.onClick}>{props.label}</Button>\n}\n\nfunction ButtonDonotThing(props) {\n  return <Button variant=\"secondary\" size=\"lg\" className=\"button-donot-thing\" onClick={props.onClick}>{props.label}</Button>\n}\n\nconst radios = [\n  { name: 'Mapping', value: '1' },\n  { name: 'Localization',   value: '2' },\n];\n\nconst arrVel = [\n  [\n    [1, 0, 0, 0, 0, 1],\n    [1, 0, 0, 0, 0, 0],\n    [1, 0, 0, 0, 0, -1],\n    [0, 0, 0, 0, 0, 1],\n    [0, 0, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, -1],\n    [-1, 0, 0, 0, 0, -1],\n    [-1, 0, 0, 0, 0, 0],\n    [-1, 0, 0, 0, 0, 1],\n  ],\n  [\n    [1, -1, 0, 0, 0, 0],  \n    [1, 0, 0, 0, 0, 0],\n    [1, 1, 0, 0, 0, 0],\n    [0, -1, 0, 0, 0, 0],\n    [0, 0, 0, 0, 0, 0],\n    [0, 1, 0, 0, 0, 0],\n    [-1, -1, 0, 0, 0, 0],\n    [-1, 0, 0, 0, 0, 0],\n    [-1, 1, 0, 0, 0, 0],\n  ]\n];\n\nclass Controller extends Component {\n  constructor(props) {\n    super(props);\n    // this.onControl = props.onControl;\n    this.state = {\n      keyboard_enable: false,\n      radioValue: '1',\n      checked: false,\n    };\n    this.angularVel = props.angularVel || 0;\n    this.linearVel = props.linearVel || 0;\n    this.ros = props.ros || null;\n    this.addEventKeyboard = false;\n    this.onChangeKeyboardControl = this.onChangeKeyboardControl.bind(this);\n    this.onClickControlButton = this.onClickControlButton.bind(this);\n    this._handleKeyDown = this._handleKeyDown.bind(this);\n    this.onControl = this.onControl.bind(this);\n    this.cur_dir = 4; // stop\n    this.cmdVel = null;\n    this.mappingModeService = null;\n    this.localizationModeService = null;\n  }\n\n  _handleKeyDown = (event) => {\n    // console.log(\"pressed \" + event.keyCode);\n    let target = Command.find(item => {\n      if (item.code === event.keyCode) {\n        return item;\n      }\n    });\n    if (target) {\n      // console.log(\"press dir \" + target.dir);\n      this.onControl(0, target.dir);\n    }\n  }\n\n  componentDidUpdate() {\n    this.angularVel = this.props.angularVel || 0;\n    this.linearVel = this.props.linearVel || 0;\n    if (this.ros !== this.props.ros) {\n      this.ros = this.props.ros;\n      if (this.ros != null) {\n        console.log('abc')\n        this.cmdVel = new ROSLIB.Topic({\n          ros : this.ros,\n          name : '/cmd_vel_mux/safety_controller',\n          messageType : 'geometry_msgs/Twist'\n        });\n        var newVelMsg = new ROSLIB.Message({\n          linear : {\n            x : 0,\n            y : 0,\n            z : 0,\n          },\n          angular : {\n            x : 0,\n            y : 0,\n            z : 0,\n          }\n        });\n        this.cur_dir = 4;\n        this.cmdVel.publish(newVelMsg);\n\n        this.mappingModeService = new ROSLIB.Service({\n          ros: this.ros,\n          name: '/rtabmap/set_mode_mapping',\n          serviceType: 'std_srvs/Empty'\n        });\n        this.localizationModeService = new ROSLIB.Service({\n          ros: this.ros,\n          name: '/rtabmap/set_mode_localization',\n          serviceType: 'std_srvs/Empty'\n        });\n      }\n    }\n  }\n\n  componentDidMount() {\n    // BannerDataStore.addChangeListener(this._onchange);\n    // document.addEventListener(\"keydown\", this._handleKeyDown);\n  }\n\n  componentWillUnmount() {\n    // BannerDataStore.removeChangeListener(this._onchange);\n    if (this.addEventKeyboard) {\n      document.removeEventListener(\"keydown\", this._handleKeyDown);\n    }\n  }\n\n  onChangeKeyboardControl(event) {\n    console.log(\"change switch \" + event.target.checked);\n    this.setState({ keyboard_enable: event.target.checked });\n    if (event.target.checked === true) {\n      if (!this.addEventKeyboard) {\n        console.log(\"Enable keyboard\");\n        document.addEventListener(\"keydown\", this._handleKeyDown);\n        this.addEventKeyboard = true;\n      }\n    } else if (event.target.checked === false) {\n      if (this.addEventKeyboard) {\n        console.log(\"Disable keyboard\");\n        document.removeEventListener(\"keydown\", this._handleKeyDown);\n        this.addEventKeyboard = false;\n      }\n    }\n  }\n\n  onControl(mode, dir) {\n    this.cur_dir = dir;\n    if (!this.cmdVel || this.ros == null) {\n      return;\n    }\n    console.log(\"mode \" + mode + \" direction \" + dir + \" with velocity \" + this.linearVel + \", \" + this.angularVel);\n    if (mode > 1 || mode < 0 || dir < 0 || dir > 9) {\n      console.log(\"Invalid control\");\n    }\n    var newVelMsg = new ROSLIB.Message({\n      linear : {\n        x : arrVel[mode][dir][0] * this.linearVel,\n        y : arrVel[mode][dir][1] * this.linearVel,\n        z : arrVel[mode][dir][2] * this.linearVel,\n      },\n      angular : {\n        x : arrVel[mode][dir][3] * this.angularVel,\n        y : arrVel[mode][dir][4] * this.angularVel,\n        z : arrVel[mode][dir][5] * this.angularVel,\n      }\n    });\n    this.cmdVel.publish(newVelMsg);\n  }\n\n  onClickControlButton(direction) {\n    console.log(\"click \" + direction);\n    this.onControl(0, direction);\n  }\n\n  render() {\n    return (\n      <Container className=\"box-margin\">\n        <Card border=\"secondary\">\n          <Card.Header style={{fontSize: \"1.2rem\" }}><strong>Controller</strong></Card.Header>\n          <Card.Body>\n            <Row md={3} >\n              <Col>Keyboard Control</Col>\n              <Col>\n                <label className=\"switch\">\n                  <input onChange={this.onChangeKeyboardControl} checked={this.state.keyboard_enable} type=\"checkbox\" />\n                  <span className=\"slider round\"></span>\n                </label>\n              </Col>\n            </Row>\n            <Row>\n              <Col><ControlButton label=\"Q\" onClick={() => this.onClickControlButton(Direction.NorthWest)} /></Col>\n              <Col><ControlButton label=\"W\" onClick={() => this.onClickControlButton(Direction.North)} /></Col>\n              <Col><ControlButton label=\"E\" onClick={() => this.onClickControlButton(Direction.NorthEast)} /></Col>\n            </Row>\n            <Row>\n              <Col><ControlButton label=\"A\" onClick={() => this.onClickControlButton(Direction.West)} /></Col>\n              <Col ><ButtonDonotThing label=\"\" onClick={() => this.onClickControlButton(Direction.Center)} /></Col>\n              <Col><ControlButton label=\"D\" onClick={() => this.onClickControlButton(Direction.East)} /></Col>\n            </Row>\n            <Row>\n              <Col><ControlButton label=\"Z\" onClick={() => this.onClickControlButton(Direction.SouthWest)} /></Col>\n              <Col><ControlButton label=\"S\" onClick={() => this.onClickControlButton(Direction.South)} /></Col>\n              <Col><ControlButton label=\"C\" onClick={() => this.onClickControlButton(Direction.SouthEast)} /></Col>\n            </Row>\n            {/* <Row style={{borderBottom: \"1px dotted gray\", paddingBottom: \"1rem\"}}>\n              <Col><Button variant=\"secondary\" size=\"lg\" style={{ width: \"100%\", height: \"6ex\", margin: \"0.75ex\" }}>Shift</Button></Col>\n            </Row> */}\n            <Row style={{marginTop: \"1rem\"}}>\n              <Col sm={4}><p style={{margin: \"0.5rem\", fontSize: \"1.1rem\", textAlign: \"center\"}}>Mode</p></Col>\n              <Col>\n                <ButtonGroup toggle>\n                  {radios.map((radio, idx) => (\n                    <ToggleButton\n                      key={idx}\n                      type=\"radio\"\n                      variant=\"secondary\"\n                      name=\"radio\"\n                      value={radio.value}\n                      checked={this.state.radioValue === radio.value}\n                      onChange = {(e) => {\n                        this.setState({radioValue: e.currentTarget.value});\n                        e.currentTarget.value === '1' ? this.mappingModeService.callService() : this.localizationModeService.callService();\n                      }}>\n                      {radio.name}\n                    </ToggleButton>\n                  ))}\n                </ButtonGroup>\n              </Col>\n            </Row>\n          </Card.Body>\n        </Card>\n      </Container>\n    )\n  }\n}\n\nexport default Controller;"]},"metadata":{},"sourceType":"module"}